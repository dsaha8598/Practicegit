<div
  class="row mt-20"
  *ngIf="
    enableActionsBasedType('mismatches') ||
    enableActionsBasedType('adjustments-view')
  "
>
  <div class="col-sm-9 py-5 pl-20">
    <ey-custom-checkbox
      [id]="'selectAll'"
      [checked]="selectAll"
      (valueEmitter)="selectAllHandler($event)"
    >
    </ey-custom-checkbox>
    Select All
    <span class="mx-30 text-muted">{{
      this.selectedIds.length +
        ' of ' +
        this.pageObject.data.length +
        ' in ' +
        this.pageObject.count +
        ' selected'
    }}</span>
  </div>
  <div class="col-sm-3" *ngIf="enableActionsBasedType('mismatches')">
    <select
      name="actions"
      id="actions"
      class="form-control"
      (change)="rowDataEmitter.emit({ action: $event, value: selectedIds })"
      [(ngModel)]="invoiceAction"
    >
      <option value="0">Select Action</option>
      <option value="accept" *ngIf="mismatchcategory !== 'NAD'">Accept </option>
      <option value="reject">Reject</option>
      <option value="modify">Modify</option>
    </select>
  </div>
</div>
<p-table
  [columns]="tableOptionColumns"
  [totalRecords]="pageObject?.count"
  [value]="pageObject?.data"
  [scrollable]="true"
  [resizableColumns]="true"
>
  <ng-template pTemplate="caption">
    <div class="ui-g">
      <div class="ui-g-12 ui-md-4">
        <div style="text-align:left" *ngIf="toggleColumns">
          <p-multiSelect
            [options]="tableColumns"
            name="tableOptionColumns"
            optionLabel="header"
            selectedItemsLabel="{0} columns selected"
            [style]="{ minWidth: '200px' }"
            [(ngModel)]="tableOptionColumns"
            defaultLabel="Choose Columns"
            ngDefaultControl
          >
          </p-multiSelect>
        </div>
      </div>
      <div
        class="ui-inputgroup ui-inputgroup-cust ui-g-8 mx-0"
        *ngIf="
          type == 'HSN/SAC-NOI mappings' ||
          type == 'TDS_HSN_CODE_EXCEL_APPLICATION'
        "
      >
        <div class="relative">
          <input
            type="text"
            pInputText
            [(ngModel)]="searchKey"
            (change)="getSearchData()"
            placeholder="Search with HSN/SAC code"
            class="input-ctrl input-search-type"
          />
          <button type="submit" class="input-search pi pi-search"></button>
        </div>
      </div>
      <div class="ui-inputgroup ui-inputgroup-cust ui-g-4 mx-0">
        <div class="relative">
          <ng-container *ngTemplateOutlet="searchFilterRef"></ng-container>
        </div>
      </div>
      <ng-container *ngTemplateOutlet="monthYearRef"></ng-container>
    </div>
  </ng-template>
  <ng-template pTemplate="colgroup" let-columns>
    <colgroup>
      <col
        *ngFor="let col of columns"
        style="width:200px"
        [style.width]="col.width"
      />
    </colgroup>
  </ng-template>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th
        *ngFor="let col of columns"
        [style.width]="col.width"
        pResizableColumn
      >
        {{ col.header }}
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns">
    <tr>
      <td *ngFor="let col of columns" [style.width]="col.width">
        <div class="ellipse m-0">
          <span *ngIf="col.type !== 'action'">
            <span *ngIf="col.type === 'initial'">
              <ey-redirect-to-route
                *ngIf="enableActionsBasedType('resident-deductee')"
                [data]="rowData"
                [type]="'RES'"
                [action]="'view'"
                [colField]="col.field"
              >
              </ey-redirect-to-route>
              <ey-redirect-to-route
                *ngIf="enableActionsBasedType('TDS_HSN_CODE_EXCEL_APPLICATION')"
                [data]="rowData"
                [type]="'TDS_HSN_CODE_EXCEL_APPLICATION'"
                [action]="'view'"
                [colField]="col.field"
              >
              </ey-redirect-to-route>
              <ey-redirect-to-route
                *ngIf="enableActionsBasedType('non-resident-deductee')"
                [data]="rowData"
                [type]="'NR'"
                [action]="'view'"
                [colField]="col.field"
              >
              </ey-redirect-to-route>
            </span>

            <span *ngIf="col.type === 'residentialStatus'">
              {{
                rowData[col.field] == 'RES' ? 'Resident' : 'Non-Resident'
              }}</span
            >
            <span *ngIf="col.type === 'panstatus'">
              {{ rowData[col.field] | titlecase }}</span
            >
            <span *ngIf="col.type === 'amount'">{{
              rowData[col.field] | convertlocalamount
            }}</span>
            <span *ngIf="col.type === 'date'">{{
              rowData[col.field] | date: 'dd/MM/yyyy'
            }}</span>
          </span>
          <span *ngIf="col.type === 'keydate'">{{
            rowData.key[col.field] | date: 'dd/MM/yyyy'
          }}</span>
          <p *ngIf="col.type === 'boolean'">
            <i
              class="fa fa-check text-success"
              aria-hidden="true"
              *ngIf="rowData[col.field]"
            ></i>
            <i
              class="fa fa-times text-danger"
              aria-hidden="true"
              *ngIf="!rowData[col.field]"
            ></i>
          </p>
          <span
            *ngIf="
              !col.type && col.type !== 'action' && col.type !== 'panStatus'
            "
            [ngbTooltip]="rowData[col.field]"
            container="body"
            >{{ rowData[col.field] }}</span
          >
          <span *ngIf="col.type === 'action'">
            <span *ngIf="enableActionsBasedType('non-resident')">
              <a href="javascript:void(0);" (click)="emitRowData(rowData)"
                >Validate</a
              >
            </span>
            <span *ngIf="enableActionsBasedType('adjustments')">
              <a
                href="javascript:void(0);"
                (click)="emitRowData({ data: rowData, type: 'adjust' })"
                >Adjust</a
              >
              |
              <a
                href="javascript:void(0);"
                (click)="emitRowData({ data: rowData, type: 'adjust-current' })"
              >
                Adjust against current month</a
              >
              |
              <a
                href="javascript:void(0);"
                (click)="emitRowData({ data: rowData, type: 'reject' })"
                >Reject</a
              >
            </span>
            <span
              *ngIf="enableActionsBasedType('TDS_HSN_CODE_EXCEL_APPLICATION')"
            >
              <ey-redirect-to-route
                [data]="rowData"
                [type]="'TDS_HSN_CODE_EXCEL_APPLICATION'"
                [action]="'edit'"
                [colField]="col.field"
              >
              </ey-redirect-to-route>
            </span>
            <span *ngIf="enableActionsBasedType('resident-deductee')">
              <ey-redirect-to-route
                [data]="rowData"
                [type]="'RES'"
                [action]="'edit'"
                [colField]="col.field"
              >
              </ey-redirect-to-route>
              <span
                *ngIf="
                  rowData['deducteePAN'] &&
                  (panStatusCheck(rowData['panStatus']) ||
                    !rowData['panStatus'])
                "
              >
                |
              </span>
              <span *ngIf="rowData['deducteePAN']">
                <a
                  *ngIf="!rowData['panStatus']"
                  href=" javascript:void(0)"
                  (click)="rowDataEmitter.emit(rowData)"
                  >Validate PAN</a
                >
                <a
                  *ngIf="panStatusCheck(rowData['panStatus'])"
                  href=" javascript:void(0)"
                  (click)="rowDataEmitter.emit(rowData)"
                  >Revalidate PAN</a
                >
              </span>
            </span>
            <span
              *ngIf="
                enableActionsBasedType('mismatches') ||
                enableActionsBasedType('adjustments-view')
              "
            >
              <ey-custom-checkbox
                [id]="rowData.id"
                [checked]="selectAll"
                (valueEmitter)="selectedValuesListner($event)"
              >
              </ey-custom-checkbox>
            </span>
            <span *ngIf="enableActionsBasedType('non-resident-deductee')">
              <ey-redirect-to-route
                [data]="rowData"
                [type]="'NR'"
                [action]="'edit'"
                [colField]="col.field"
              >
              </ey-redirect-to-route>
            </span>
          </span>
        </div>
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage" let-columns>
    <tr>
      <td [attr.colspan]="columns.length">
        No records found
      </td>
    </tr>
  </ng-template>
</p-table>
<div class="pagination-wrapper" *ngIf="!disablePagination">
  <div class="page-counter">
    <p>
      Total records found:
      <span>
        {{ pageObject.count }}
      </span>
    </p>
  </div>
  <div class="page-actions">
    <div class="page-selector">
      <button
        class="page-prev"
        [disabled]="pageObject.isPrev"
        (click)="prevPage()"
      >
        Prev
      </button>
      <button class="page-number">{{ pageObject?.pageNumber }}</button>
      <button
        class="page-next"
        [disabled]="pageObject.isNext"
        (click)="nextPage()"
      >
        Next
      </button>
    </div>
    <div class="page-size">
      <select
        name="pagination"
        id="pagination"
        class="form-control"
        (change)="pageSizeChangeHandler($event)"
      >
        <option *ngFor="let item of pageSizeList" value="{{ item.value }}">{{
          item.label
        }}</option>
      </select>
    </div>
  </div>
</div>
