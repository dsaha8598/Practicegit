<div class="ui-g-12">
  <div class="">
    <div class="ui-g">
      <div class="check-Control">
        <div class="ui-g-12 mx-0">
          <h2 class="fs-22">Approve Role Permissions</h2>
        </div>
        <div class="ui-g-12">
          <form [formGroup]="roleForm">
            <div class="form-row">
              <div class="ui-inputgroup ui-g-6">
                <label for="inputCity" class="ui-g-6">Role Name</label>
                <div
                  class="ui-g-8"
                  [ngClass]="{
                    'field-invalid': submitted && r.roleName.errors
                  }"
                >
                  <p-dropdown
                    [options]="rolesListData"
                    formControlName="roleName"
                    placeholder="Select a Role"
                    (onChange)="showRolePermissions($event)"
                    ngDefaultControl
                    [(ngModel)]="roleName"
                    [disabled]="isViewPermissions"
                  ></p-dropdown>
                  <div
                    *ngIf="submitted && r.roleName.errors"
                    class="error-feedback"
                  >
                    <div *ngIf="r.roleName.errors.required">
                      Please select rolename.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
          <div class="form-row checkbox-Cust" *ngIf="showPermissions">
            <label for="inputCity" class="ui-g-8 pl-15"
              >Please Select Permissions:</label
            >
            <div class="ui-inputgroup ui-g-12 mb-0 sideCheck">
              <div
                class="col-12 mt-10"
                *ngFor="
                  let tab of selectedPermissionsData;
                  let i = index;
                  let even = even
                "
              >
                <div class="form-group">
                  <input
                    class="form-control"
                    type="checkbox"
                    id="{{ tab.tabName }}"
                    checked="{{ tab.isTabChecked }}"
                    name="{{ tab.tabName }}"
                    [disabled]="isViewPermissions"
                    (change)="
                      onPermissionSelect(
                        $event,
                        tab.authority.permissionDisplayName,
                        tab.authority.permissionName,
                        i,
                        'tabtrue',
                        undefined,
                        undefined
                      )
                    "
                  />
                  <label for="{{ tab.tabName }}">{{
                    tab.authority.permissionDisplayName
                  }}</label>
                </div>
                <div *ngIf="tab.groupNameList.length != 0">
                  <div *ngFor="let group of tab.groupNameList; let j = index">
                    <div class="pl-38">
                      <div class="form-group">
                        <input
                          class="form-control"
                          type="checkbox"
                          id="{{ group.groupName }}"
                          checked="{{ group.isGroupChecked }}"
                          [disabled]="isViewPermissions"
                          name="{{ group.groupName }}"
                          [(ngModel)]="selectedGroups[group.groupName]"
                          (change)="
                            onPermissionSelect(
                              $event,
                              group.authority.permissionDisplayName,
                              group.authority.permissionName,
                              i,
                              'grouptrue',
                              j,
                              undefined
                            )
                          "
                        />
                        <label
                          for="{{ group.groupName }}"
                          *ngIf="group.authority != null"
                          >{{ group.authority.permissionDisplayName }}</label
                        >
                      </div>
                    </div>
                    <div
                      *ngFor="let label of group.labels; let l = index"
                      class="pl-38 col-sm-12"
                    >
                      <div class="pl-38">
                        <div class="form-group">
                          <input
                            class="form-control"
                            type="checkbox"
                            id="{{ label.labelName }}"
                            [disabled]="isViewPermissions"
                            checked="{{ label.isLabelChecked }}"
                            name="{{ label.labelName }}"
                            [(ngModel)]="selectedLabels[label.labelName]"
                            (change)="
                              onPermissionSelect(
                                $event,
                                label.authority.permissionDisplayName,
                                label.authority.permissionName,
                                i,
                                undefined,
                                j,
                                l
                              )
                            "
                          />
                          <label for="{{ label.labelName }}">{{
                            label.authority.permissionDisplayName
                          }}</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div
            class="ui-inputgroup text-center mt-30"
            *ngIf="formType == 'view'"
          >
            <button
              type="button"
              class="ui-button btn-secondary"
              (click)="hideForm()"
            >
              <i class="far fa-times-circle"></i> Cancel
            </button>

          </div>
          <div
            class="ui-inputgroup text-center mt-30"
            *ngIf="formType == 'form' && showPermissions"
          >
            <button
              type="button"
              class="ui-button btn-secondary"
              (click)="hideForm()"
            >
              <i class="far fa-times-circle"></i> Cancel
            </button>
            <button
              (click)="createRole()"
              type="button"
              class="ui-button btn-primary mr-30"
            >
              <i class="fas fa-save"></i> Approve Role
            </button>
          </div>
          <div
            class="ui-inputgroup text-center mt-30"
            *ngIf="formType == 'form' && !showPermissions"
          >
            <span class="text-muted py-10 mb-0fs-18"
              >Note: Please Select Role to view permissions</span
            >
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
