<div class="ui-g-12 text-right">
  <span *HasAnyAuthority="['TCS_SAC_DESCRIPTION_UPLOAD']">
    <button type="button" class="ui-button btn-primary" (click)="showDialog()">
      <i class="fas fa-upload"></i> Upload
    </button>
  </span>
</div>

<div class="ui-g-12">
  <div class="relative">
    <p-tabView class="table-tab-view">
      <p-tabPanel header="HSN/SAC-NOI mappings list">
        <!-- <p-table
          #dt1
          [columns]="selectedColumns"
          [paginator]="false"
          [rows]="5"
          [rowsPerPageOptions]="[5, 10, 20, 30]"
          [totalRecords]="sacDescList?.length"
          [value]="sacDescList"
          [scrollable]="true"
          scrollHeight="200px"
        >
          <ng-template pTemplate="caption">
            <div class="ui-g">
              <div class="ui-g-12 ui-md-4 mx-0">
                <div style="text-align:left">
                  <p-multiSelect
                    [options]="cols"
                    optionLabel="header"
                    [(ngModel)]="selectedColumns"
                    name="selectedColumn"
                    selectedItemsLabel="{0} columns selected"
                    [style]="{ minWidth: '200px' }"
                    defaultLabel="Choose Columns"
                    ngDefaultControl
                  ></p-multiSelect>
                </div>
              </div>
              <div class="ui-inputgroup ui-inputgroup-cust ui-g-8 mx-0">
                <div class="relative">
                  <input
                    type="text"
                    pInputText
                    placeholder="Search"
                    (input)="dt1.filterGlobal($event.target.value, 'contains')"
                    class="input-ctrl input-search-type"
                  />
                  <button
                    type="submit"
                    class="input-search pi pi-search"
                  ></button>
                </div>
              </div>
            </div>
          </ng-template>
          <ng-template pTemplate="colgroup" let-columns="columns">
            <colgroup>
              <col *ngFor="let col of columns" [style.width]="col.width" />
            </colgroup>
          </ng-template>
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th
                *ngFor="let col of columns; let i = index"
                [pSortableColumn]="col.field"
                [style.width]="col.width"
              >
                {{ col.header }}</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr>
              <td
                *ngFor="let col of columns; let i = index"
                [style.width]="col.width"
              >
                <p
                  class="ellipse"
                  *ngIf="col.type === 'key'"
                  [ngbTooltip]="rowData[col.field]"
                  container="body"
                >
                  {{ rowData.key[col.field] }}
                </p>
                <p
                  class="ellipse"
                  *ngIf="col.type !== 'key'"
                  [ngbTooltip]="rowData[col.field]"
                  container="body"
                >
                  {{ rowData[col.field] }}
                </p>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage" let-columns>
            <tr>
              <td [attr.colspan]="columns.length">
                No records found
              </td>
            </tr>
          </ng-template>
        </p-table> -->
        <ey-pagination
          #resident
          [tableColumns]="selectedColumns"
          [pageObjectInput]="sacDescList"
          (pageObjectEmitter)="setPageObject($event)"
          [type]="'HSN/SAC-NOI mappings'"
        >
          <!-- <ng-template #searchFilter>
            <ey-deductee-resident-dropdown
              [isDeducteeMaster]="true"
              (onChange)="filterDatabyDeducteeName($event, 'resident')"
            >
            </ey-deductee-resident-dropdown>
          </ng-template> -->
        </ey-pagination>
      </p-tabPanel>
    </p-tabView>
  </div>
</div>

<div class="fixed-footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-12">
        <button
          (click)="backClick()"
          type="button"
          class="ui-button btn-utility"
        >
          <i class="fas fa-arrow-left"></i> Back
        </button>
      </div>
    </div>
  </div>
</div>

<p-dialog
  header="Upload"
  [(visible)]="display"
  [style]="{ width: '800px' }"
  [modal]="true"
  [contentStyle]="{ overflow: 'visible' }"
  [minY]="70"
  (onHide)="clearUpload()"
  [maximizable]="true"
  [baseZIndex]="10000"
>
  <form [formGroup]="sacUploadForm">
    <div class="p-20">
      <div
        class="no-files m-20"
        *ngIf="!filesExists && !uploadSuccess && !uploadError && !fileLoading"
      >
        <p class="fs-18">
          No files added. Please click add files button to upload files.
        </p>
        <span class="fs-14 mt-20">
          Note: Upload .xlsx files only.
        </span>
      </div>
      <div class="text-center my-50" *ngIf="fileLoading">
        <i class="fs-24 fas fa-hourglass-start fa-spin text-success mb-30"></i>
        <p class="fs-16">Your file is being processed. please wait.</p>
      </div>
      <div class="text-center my-50" *ngIf="uploadSuccess">
        <i class="fs-80 fa fa-check-circle text-success mb-30"></i>
        <p class="fs-24">File Uploaded Successfully.</p>
      </div>
      <div class="text-center my-50" *ngIf="uploadError">
        <i class="fs-80 fa fa-times text-danger mb-30"></i>
        <p class="fs-24">Processing failed.</p>
      </div>
      <div
        class="files p-20"
        *ngIf="filesExists && !uploadSuccess && !uploadError && !fileLoading"
      >
        <div class="alert alert-success">
          {{ rawValues?.file.length }} has been added successfully. Please click
          upload files to process files.
        </div>
        <div
          class="bg-light mb-10 p-20 row mx-0"
          *ngFor="let file of rawValues.file; let i = index"
        >
          <div class="col-sm-8">
            {{ file.name }}
          </div>
          <div class="col-sm-2">
            {{ formatBytes(file.size) }}
          </div>
          <div class="col-sm-2">
            <button
              type="button"
              class="ui-button btn-secondary"
              (click)="removeFiles()"
            >
              <i class="pi pi-times"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </form>
  <p-footer *ngIf="!fileLoading && !uploadSuccess && !uploadError">
    <span *ngIf="!filesExists">
      <input
        type="file"
        class="inputfile"
        id="keywordsfiles"
        (change)="uploadHandler($event)"
        accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
      />
      <label for="keywordsfiles" class="mb-0">Add files</label>
    </span>
    <button
      type="button"
      class="ui-button btn-secondary"
      *ngIf="filesExists"
      (click)="uploadFiles()"
    >
      Upload files
    </button>
  </p-footer>
</p-dialog>
